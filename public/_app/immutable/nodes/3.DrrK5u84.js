import{d as we,a as B,s as ze,f as N,e as ke,b as L,g as H,c as V}from"../chunks/CQx0q4k3.js";import{R as xe,U as Ee,V as Pe,X as Se,$ as Ve,Z as o,Y as a,e,_ as n,S as b,a1 as M,W as s,a2 as re,a0 as T}from"../chunks/QCr8S_d5.js";import{i as ie}from"../chunks/afW7fTtA.js";import{h as Re,r as g,a as W}from"../chunks/CbCIeqGS.js";import{i as Ie,s as oe,t as r,l as ee}from"../chunks/NuMtav88.js";import{b as w,a as De}from"../chunks/BKpjlwVq.js";import{g as J}from"../chunks/u8Pq6ae7.js";var Ue=N('<div class="verify-section svelte-1s728sz"><p class="verify-msg svelte-1s728sz">Enter the 6-digit code sent to <strong> </strong></p> <form class="svelte-1s728sz"><input type="text" placeholder="000000" maxlength="6" class="code-input svelte-1s728sz" autocomplete="one-time-code"/> <button type="submit" class="submit-btn svelte-1s728sz"> </button></form> <button class="link-btn svelte-1s728sz">Resend code</button> <button class="link-btn svelte-1s728sz">Back to sign in</button></div>'),qe=N('<div class="verify-section svelte-1s728sz"><p class="verify-msg svelte-1s728sz">Enter your email to receive a reset code</p> <form class="svelte-1s728sz"><input type="email" placeholder="Email" autocomplete="email"/> <button type="submit" class="submit-btn svelte-1s728sz"> </button></form> <button class="link-btn svelte-1s728sz">Back to sign in</button></div>'),Be=N('<div class="verify-section svelte-1s728sz"><p class="verify-msg svelte-1s728sz">Enter the code sent to <strong> </strong> and your new password</p> <form class="svelte-1s728sz"><input type="text" placeholder="000000" maxlength="6" class="code-input svelte-1s728sz" autocomplete="one-time-code"/> <input type="password" placeholder="New password (6+ chars)" autocomplete="new-password"/> <input type="password" placeholder="Verify new password" autocomplete="new-password"/> <button type="submit" class="submit-btn svelte-1s728sz"> </button></form> <button class="link-btn svelte-1s728sz">Resend code</button> <button class="link-btn svelte-1s728sz">Back to sign in</button></div>'),Le=N('<input type="text" placeholder="Username" maxlength="30" autocomplete="username"/> <input type="email" placeholder="Email" autocomplete="email"/> <input type="email" placeholder="Verify email"/> <input type="password" placeholder="Password (6+ chars)" autocomplete="new-password"/> <input type="password" placeholder="Verify password" autocomplete="new-password"/> <button type="submit" class="submit-btn svelte-1s728sz"> </button>',1),Ne=N('<input type="email" placeholder="Email" autocomplete="email"/> <input type="password" placeholder="Password" autocomplete="current-password"/> <label class="remember svelte-1s728sz"><input type="checkbox" class="svelte-1s728sz"/> <span>Remember me</span></label> <button type="submit" class="submit-btn svelte-1s728sz"> </button> <button type="button" class="link-btn svelte-1s728sz">Forgot password?</button>',1),Ae=N('<div class="tabs svelte-1s728sz"><button>Sign In</button> <button>Sign Up</button></div> <form class="svelte-1s728sz"><!></form>',1),Ce=N('<div class="auth-page svelte-1s728sz"><div class="auth-card svelte-1s728sz"><h1 class="svelte-1s728sz">◉ Pulse</h1> <!></div></div>');function je(ne,le){xe(le,!0);const de=()=>ke(Ie,"$isLoggedIn",ue),[ue,ce]=ze();Ee(()=>{de()&&J("/")});let _=b("signin"),y=b(""),z=b(""),$=b(""),Z=b(""),j=b(""),x=b(""),A=b(""),K=b(!1),i=b(!1);async function me(){if(!e($).trim()||!e(y).trim()||!e(z)){r.add("All fields are required","error");return}if(e(y)!==e(Z)){r.add("Emails do not match","error");return}if(e(z)!==e(j)){r.add("Passwords do not match","error");return}if(e(z).length<6){r.add("Password must be at least 6 characters","error");return}s(i,!0);try{const t=await W.signup({username:e($).trim(),email:e(y).trim(),password:e(z)});s(A,t.email,!0),s(_,"verify"),r.add("Verification code sent to your email","success")}catch(t){r.add(t.message,"error")}finally{s(i,!1)}}async function ve(){if(!e(x).trim()){r.add("Enter the 6-digit code","error");return}s(i,!0);try{const t=await W.verify({email:e(A),code:e(x).trim()});ee(t.token,t.username),r.add("Email verified!","success"),J("/")}catch(t){r.add(t.message,"error")}finally{s(i,!1)}}async function te(){try{await W.resend({email:e(A)}),r.add("New code sent","success")}catch(t){r.add(t.message,"error")}}async function pe(){if(!e(y).trim()||!e(z)){r.add("Email and password required","error");return}s(i,!0);try{const t=await W.signin({email:e(y).trim(),password:e(z)});t.needsVerification?(s(A,t.email,!0),s(_,"verify"),r.add("Please verify your email first","error")):(ee(t.token,t.username,e(K)),r.add("Welcome back!","success"),J("/"))}catch(t){t.message==="Email not verified"?(s(A,e(y).trim(),!0),s(_,"verify"),te()):r.add(t.message,"error")}finally{s(i,!1)}}let E=b(""),R=b(""),G=b("");async function se(){if(!e(E).trim()){r.add("Enter your email","error");return}s(i,!0);try{await W.forgot({email:e(E).trim()}),s(_,"reset"),r.add("If that email is registered, a reset code has been sent","success")}catch(t){r.add(t.message,"error")}finally{s(i,!1)}}async function fe(){if(!e(x).trim()||!e(R)){r.add("Code and new password required","error");return}if(e(R)!==e(G)){r.add("Passwords do not match","error");return}if(e(R).length<6){r.add("Password must be at least 6 characters","error");return}s(i,!0);try{const t=await W.resetPassword({email:e(E).trim(),code:e(x).trim(),password:e(R)});ee(t.token,t.username),r.add("Password reset!","success"),J("/")}catch(t){r.add(t.message,"error")}finally{s(i,!1)}}function C(t){s(_,t,!0),s(y,""),s(z,""),s($,""),s(Z,""),s(j,""),s(x,""),s(E,""),s(R,""),s(G,"")}var O=Ce();Re("1s728sz",t=>{Se(()=>{Ve.title="Pulse — Sign In"})});var ae=o(O),be=a(o(ae),2);{var ge=t=>{var v=Ue(),l=o(v),f=a(o(l)),k=o(f,!0);n(f),n(l);var p=a(l,2),h=o(p);g(h);var d=a(h,2),I=o(d,!0);n(d),n(p);var P=a(p,2),X=a(P,2);n(v),M(()=>{L(k,e(A)),d.disabled=e(i),L(I,e(i)?"Verifying…":"Verify")}),H("submit",p,u=>{u.preventDefault(),ve()}),w(h,()=>e(x),u=>s(x,u)),V("click",P,te),V("click",X,()=>C("signin")),B(t,v)},_e=t=>{var v=qe(),l=a(o(v),2),f=o(l);g(f);var k=a(f,2),p=o(k,!0);n(k),n(l);var h=a(l,2);n(v),M(()=>{k.disabled=e(i),L(p,e(i)?"Sending…":"Send reset code")}),H("submit",l,d=>{d.preventDefault(),se()}),w(f,()=>e(E),d=>s(E,d)),V("click",h,()=>C("signin")),B(t,v)},ye=t=>{var v=Be(),l=o(v),f=a(o(l)),k=o(f,!0);n(f),re(),n(l);var p=a(l,2),h=o(p);g(h);var d=a(h,2);g(d);var I=a(d,2);g(I);var P=a(I,2),X=o(P,!0);n(P),n(p);var u=a(p,2),D=a(u,2);n(v),M(()=>{L(k,e(E)),P.disabled=e(i),L(X,e(i)?"Resetting…":"Reset password")}),H("submit",p,c=>{c.preventDefault(),fe()}),w(h,()=>e(x),c=>s(x,c)),w(d,()=>e(R),c=>s(R,c)),w(I,()=>e(G),c=>s(G,c)),V("click",u,se),V("click",D,()=>C("signin")),B(t,v)},he=t=>{var v=Ae(),l=T(v),f=o(l);let k;var p=a(f,2);let h;n(l);var d=a(l,2),I=o(d);{var P=u=>{var D=Le(),c=T(D);g(c);var U=a(c,2);g(U);var q=a(U,2);g(q);var F=a(q,2);g(F);var S=a(F,2);g(S);var Y=a(S,2),Q=o(Y,!0);n(Y),M(()=>{Y.disabled=e(i),L(Q,e(i)?"Creating account…":"Sign Up")}),w(c,()=>e($),m=>s($,m)),w(U,()=>e(y),m=>s(y,m)),w(q,()=>e(Z),m=>s(Z,m)),w(F,()=>e(z),m=>s(z,m)),w(S,()=>e(j),m=>s(j,m)),B(u,D)},X=u=>{var D=Ne(),c=T(D);g(c);var U=a(c,2);g(U);var q=a(U,2),F=o(q);g(F),re(2),n(q);var S=a(q,2),Y=o(S,!0);n(S);var Q=a(S,2);M(()=>{S.disabled=e(i),L(Y,e(i)?"Signing in…":"Sign In")}),w(c,()=>e(y),m=>s(y,m)),w(U,()=>e(z),m=>s(z,m)),De(F,()=>e(K),m=>s(K,m)),V("click",Q,()=>{s(E,e(y),!0),C("forgot")}),B(u,D)};ie(I,u=>{e(_)==="signup"?u(P):u(X,!1)})}n(d),M(()=>{k=oe(f,1,"svelte-1s728sz",null,k,{active:e(_)==="signin"}),h=oe(p,1,"svelte-1s728sz",null,h,{active:e(_)==="signup"})}),V("click",f,()=>C("signin")),V("click",p,()=>C("signup")),H("submit",d,u=>{u.preventDefault(),e(_)==="signup"?me():pe()}),B(t,v)};ie(be,t=>{e(_)==="verify"?t(ge):e(_)==="forgot"?t(_e,1):e(_)==="reset"?t(ye,2):t(he,!1)})}n(ae),n(O),B(ne,O),Pe(),ce()}we(["click"]);export{je as component};
